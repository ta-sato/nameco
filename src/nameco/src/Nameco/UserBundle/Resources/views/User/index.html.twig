{% extends "NamecoUserBundle:Admin:layout.html.twig" %}

{% block stylesheets %}
	{{ parent() }}
	<link href="{{ asset('bundles/namecouser/css/user.css') }}" rel="stylesheet" type="text/css" />
{% endblock %}
{% block javascripts %}
	{{ parent() }}
    <script type="text/javascript" src="{{ asset('bundles/namecouser/js/user.js') }}" charset="utf-8"></script>
{% endblock %}

{% block admin_contents %}
	{% for flashMessage in app.session.flashbag.get('success') %}
		    <div class="alert alert-success">{{flashMessage}}</div>
	{% endfor %}
	{% for flashMessage in app.session.flashbag.get('error') %}
		    <div class="alert alert-error">{{flashMessage}}</div>
	{% endfor %}

    <div>
		<a href="{{path('user_new')}}"><i class="icon-plus-sign"></i>新規</a>
    </div>
    <table id="user_list" class="table table-striped table-hover">
		<thead>
		    <tr>
				<th id="edit">&nbsp;</th>
				<th id="family">苗字</th>
				<th id="first">名前</th>
				<th id="mail">メールアドレス</th>
				<th id="created">作成日時</th>
				<th id="updated">更新日時</th>
				<th id="remove">&nbsp;</th>
		    </tr>
		</thead>
		<tbody>
		    {% for user in users %}
			<tr class="{% if user.isActive == false %}muted{% endif %}">
			    <td><a href="{{path('user_edit', {'id' : user.id }) }}"><i class="icon-pencil"></i>編集</a></td>
			    <td>{{user.familyName}}</td>
			    <td>{{user.firstName}}</td>
			    <td>{{user.email}}</td>
			    <td>{{user.created|date("Y/m/d H:i")}}</td>
			    <td>{{user.updated|date("Y/m/d H:i")}}</td>
			    <td> 
			    	{% spaceless %}
				    	{% if user.id != app.security.getToken().getUser().getId() %}
				    		<a id="remove_{{user.id}}" href="#" class="user_remove" ><i class="icon-trash" ></i>削除</a>
				    		<span id="remove_{{user.id}}_url" style="display:none" >{{path('user_remove', {'id' : user.id }) }}</span>
				    	{% endif %}
				    {% endspaceless %}
			   </td>
			</tr>
		    {% endfor%}
		</tbody>
    </table>
    <div class="navigation">
		{{ knp_pagination_render(users) }}
    </div>
    <div id="remove_confirm" class="modal hide fade">
		<div class="modal-header">
    		<h3>確認</h3>
		</div>
  		<div class="modal-body">
    		<p>削除します。よろしいですか？</p>
		</div>
		<div class="modal-footer">
			<a href="#" id="execute_remove" class="btn btn-primary">はい</a>
    		<a href="#" id="remove_no" class="btn">いいえ</a>
  		</div>
	</div>
{% endblock admin_contents %}
